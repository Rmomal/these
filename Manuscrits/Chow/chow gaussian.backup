\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amssymb,amsthm,mathrsfs,amsfonts,dsfont,bm} 
\usepackage[margin=2.5cm]{geometry}
%opening
\title{Chow et Liu dans le cas gaussien}
\author{}


\DeclareMathOperator*{\argmax}{arg\,max}

\begin{document}

\maketitle

\begin{abstract}
Approximating Gaussian distribution with dependence Trees
\end{abstract}

\section{Notations and definitions}
Let $\bm{x}$ be a vector of n random continuous variables, $\bm{x}=(x_1,...,x_n)\in \mathcal{R}^n$. Let
$\mathcal{S}$ be a collection of samples of $\bm{x}$ : $\mathcal{S}=\{\bm{x}^1,...,\bm{x}^s\}$.\\

We consider a tree structure, each nod of the tree being a variable. All nodes $i$ except for one have an ancestor nod,
 indexed $a_i$.The structure of a tree is recorded in the vector $\bm{\alpha}=(a_1,...,a_n)$.\\

We assume Gaussian densities : 
\[f(x_i |\mu_i,\sigma_i) = \frac{1}{\sqrt{2 \pi \sigma_i^2}}\exp\left(-\frac{(x_i-\mu_i)^2}{2\sigma_i^2} \right) \]


\[f(x_i,x_{a_i} |\mu_i,\mu_{a_i},\Sigma_{ia_i}) = \frac{1}{2 \pi\sqrt{ \det(\Sigma_{ia_i})}}\exp\left(-\frac{1}{2}(x_i-\mu_i,x_{a_i}-\mu_{a_i})^T \Sigma_{ia_i}^{-1}(x_i-\mu_i,x_{a_i}-\mu_{a_i}) \right) \]

Where $\Sigma_{ia_i} = \begin{pmatrix}
\sigma_i^2 & \sigma_{ia_i} \\
\sigma_{a_ii} & \sigma_{a_i}^2
\end{pmatrix}$.\\

The gaussian dependence-tree is parametrised by $\bm{\alpha}$ :



\begin{align*} 
f(\bm{x}|\bm{\alpha},\bm{\mu},\bm{\Sigma}) &= f(x_1|\mu_1, \sigma_1) \prod_{i=2}^{n} f(x_i|x_{a_i},\mu_i, \mu_{a_i},\Sigma_{ia_i})\\
 &= f(x_1|\mu_1, \sigma_1) \prod_{i=2}^{n} \frac{f(x_i,x_{a_i}|\mu_i, \mu_{a_i},\Sigma_{ia_i})}{f(x_{a_i}|\mu_{a_i},\sigma_{a_i})}
\end{align*}

\section{Likelihood maximisation}

\subsection{Likelihood}
We want to maximise the likelihood function, which writes \\
\begin{align*} 
\mathcal{L}(\bm{\alpha},\bm{\mu},\bm{\Sigma}) &= \frac{1}{|\mathcal{S}|}\sum_{\bm{x} \in \mathcal{S}} \log (f(\bm{x}|\bm{\alpha},\bm{\mu},\bm{\Sigma})) \\
&=\frac{1}{|\mathcal{S}|}\sum_{\bm{x} \in \mathcal{S}} \left[ \log(f(x_1|\mu_1,\sigma_1)) + \sum\limits_{i=2}^n \log\left( 
\frac{f(x_i,x_{a_i}|\mu_i, \mu_{a_i},\Sigma_{ia_i})}{f(x_{a_i}|\mu_{a_i},\sigma_{a_i})} \right) \right]\\
&=\frac{1}{|\mathcal{S}|}\sum_{\bm{x} \in \mathcal{S}} \left[ \sum\limits_{i=1}^n\log(f(x_i|\mu_i,\sigma_i)) + \sum\limits_{i=2}^n \log\left( 
\frac{f(x_i,x_{a_i}|\mu_i, \mu_{a_i},\Sigma_{ia_i})}{f(x_{a_i}|\mu_{a_i},\sigma_{a_i})\times f(x_i|\mu_i,\sigma_i)} \right) \right]
\end{align*}

\subsection{Estimation}

The maximum-likelihood estimators for the parameters $\mu_i$, $\sigma_i$ and $\sigma_{ia_i}$ are known :

\begin{align*} 
\hat{\mu}_i &= \frac{1}{|\mathcal{S}|}\sum_{\bm{x} \in \mathcal{S}} x_i, \\
\hat{\sigma}_i^2 &= \frac{1}{|\mathcal{S}|}\sum_{\bm{x} \in \mathcal{S}} (x_i - \hat{\mu}_i)^2,\\
\hat{\sigma}_{ia_i}^2 &= \frac{1}{|\mathcal{S}|}\sum_{\bm{x} \in \mathcal{S}} (x_i - \hat{\mu}_i) (x_{a_i} - \hat{\mu}_{a_i})
\end{align*}

Using these estimators, we finally get

\[ \mathcal{L}(\bm{\alpha},\bm{\hat{\mu}},\bm{\hat{\Sigma}}) = \sum\limits_{i=1}^n \frac{1}{2} \left(1+\log(2\pi\hat{\sigma}_i^2)\right) + 
\sum\limits_{i=2}^n \underbrace{- \frac{1}{2} \log \left( 1- \frac{\hat{\sigma}_{ia_i}}{\hat{\sigma}_i^2 \hat{\sigma}_{ia_i}^2}\right)}_{\text{\normalsize{$\mathcal{I}\left(f
(\cdot|\hat{\mu}_i,\hat{\sigma}_i),f(\cdot|\hat{\mu}_{a_i},\hat{\sigma}_{a_i})\right)$}}}\]\\

The first term of this quantity is independant of $\alpha$, meaning it is independant of the structure of the dependance-tree. We then only need to maximise
the second term to obtain an MLE estimator for the tree structure.\\

The last term is known as the Shannon information between two variables $i$ and $a_i$. As the Shannon information is increasing with 
the correlation between these variables, it is a weight on each branch of the tree. The structure is then optimized by the maximum-weight spanning tree :

\[ \hat{\bm{\alpha}} = \argmax_\alpha \left\{ \sum\limits_{i=2}^n \mathcal{I}\left(f(\cdot|\hat{\mu}_i,\hat{\sigma}_i),
f(\cdot|\hat{\mu}_{a_i},\hat{\sigma}_{a_i})\right) \right\} \]


\end{document}
